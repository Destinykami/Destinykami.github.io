---
title: 'XMU-Computer Network'
date: 2024/1/18
permalink: /posts/2024/01/rCore_ch6/
excerpt: 'ç¬¬å…­ç«  æ–‡ä»¶ç³»ç»Ÿ'
tags:
  - rCore
  - OS
---

<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>å¦é—¨å¤§å­¦è®¡ç®—æœºç½‘ç»œ2023ç§‹å­£è¯¾ç¨‹é¡¹ç›®</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2346e101-a05f-4b04-8c57-e5d0d065cc62" class="page serif"><header><img class="page-cover-image" src="https://www.notion.so/images/page-cover/nasa_earth_grid.jpg" style="object-position:center 30.000000000000004%"/><div class="page-header-icon page-header-icon-with-cover"><span class="icon">ğŸŒ</span></div><h1 class="page-title">å¦é—¨å¤§å­¦è®¡ç®—æœºç½‘ç»œ2023ç§‹å­£è¯¾ç¨‹é¡¹ç›®</h1><p class="page-description"></p></header><div class="page-body"><hr id="1c461284-96db-4bd3-95ff-0aab20ff49de"/><h3 id="37d41347-6f36-47b6-b868-7d139ffea68a" class="block-color-default">å¦é—¨å¤§å­¦   è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ç³»   éƒ‘ç¨‹ç¡•   22920212204312</h3><hr id="8f5e37f7-c6f4-4589-91c1-2faec195800f"/><h1 id="3a213a60-c1c7-4007-8bcd-a0a6ada8bb61" class="">TCPåè®®æ ˆçš„æ„å»ºä¸æ‹“å±•è§‚å¯Ÿ</h1><h1 id="ebbeb7c7-9d93-4c7d-bbbe-f704efb7a80b" class="">ç®€ä»‹</h1><p id="89e57aaf-7a2d-4c78-b42b-95409cb41eb0" class="">TCPï¼ˆTransmission Control Protocolï¼‰æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ä¼ è¾“å±‚åè®®ï¼Œç”¨äºåœ¨ç½‘ç»œä¸Šä¼ è¾“æ•°æ®ã€‚TCPä½¿ç”¨æœ‰é™çŠ¶æ€æœºï¼ˆFinite State Machineï¼ŒFSMï¼‰æ¥æè¿°å…¶è¿è¡Œè¿‡ç¨‹ã€‚æœ‰é™çŠ¶æ€æœºæ˜¯ä¸€ç§æ•°å­¦æ¨¡å‹ï¼Œç”¨äºæè¿°ç³»ç»Ÿåœ¨ä¸åŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢å’Œè¡Œä¸ºã€‚åœ¨TCPä¸­ï¼Œæœ‰é™çŠ¶æ€æœºæè¿°äº†TCPè¿æ¥çš„ä¸åŒé˜¶æ®µå’ŒçŠ¶æ€ï¼Œä»¥åŠåœ¨è¿™äº›çŠ¶æ€ä¹‹é—´å‘ç”Ÿçš„è½¬æ¢ã€‚</p><figure id="485135e6-03e5-48e3-8abb-252a1d6e06a1" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled.png"><img style="width:528px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled.png"/></a></figure><p id="cf2fa748-7802-4081-8a86-5997a786e54d" class="">è¿™æ˜¯RFC 9293ä¸­å¯¹äºTCPæœ‰é™çŠ¶æ€æœºçš„ç®€è¦æè¿°ï¼Œå…¶ç²¾ç®€äº†ä¸€äº›è¿‡ç¨‹ã€‚</p><h1 id="6d7ef54c-8a99-45a1-99b5-73720b6844fa" class="">é¡¹ç›®ç›®æ ‡</h1><p id="cabbafbf-0cba-4805-85d9-52dbc60ad132" class="">ç°åœ¨ï¼Œä½ å·²ç»åœ¨ã€Šè®¡ç®—æœºç½‘ç»œã€‹è¯¾ç¨‹ä¸Šå­¦ä¹ äº†è®¡ç®—æœºç½‘ç»œçš„åŸºæœ¬å·¥ä½œåŸç†ä»¥åŠæ‰€é‡‡ç”¨çš„æŠ€æœ¯ï¼Œä½†è¿˜å¾ˆéš¾æŠŠè¿™äº›ç†è®ºçŸ¥è¯†ä¸æ¯å¤©ä½¿ç”¨çš„ç½‘ç»œè”ç³»èµ·æ¥ï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆè§£å†³ç”Ÿæ´»ä¸­é‡åˆ°çš„ç½‘ç»œé—®é¢˜ã€‚è¿™å°±æ˜¯è¿™ä¸ªé¡¹ç›®çš„æ„ä¹‰ï¼š<br/>ä¸€æ–¹é¢ï¼ŒæŠŠæŠ½è±¡çš„åè®®ç”¨å®é™…çš„ä»£ç å®ç°èµ·æ¥ï¼Œä½ ä¼šå‘ç°æ”¯æ’‘ç½‘ç»œçš„åº•å±‚çš„åè®®ï¼ŒåŸæ¥ç”¨ä»£ç è¿™ä¹ˆå®¹æ˜“å°±å¯ä»¥å®ç°ã€‚<br/>å¦ä¸€æ–¹é¢ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ ä¼šåˆ©ç”¨ç½‘ç»œè°ƒè¯•å·¥å…·ï¼Œè§£å†³è‡ªå·±å®ç°åè®®æ—¶å‡ºç°çš„å„ç§é—®é¢˜â€”â€”è¿™äº›è§£å†³æ–¹æ³•å¯ä»¥è¿ç§»åˆ°æ—¥å¸¸çš„ç½‘ç»œä½¿ç”¨å½“ä¸­ï¼šæœªæ¥å½“ä½ å†æ¬¡é‡åˆ°ç½‘ç»œä¸é€šçš„æ—¶å€™ï¼Œä½ å¯ä»¥ç”¨å·¥å…·å®šä½å‡ºå…·ä½“çš„é—®é¢˜ï¼Œè‡ªå·±å°è¯•è§£å†³ï¼Œè€Œä¸æ˜¯å»ç›²ç›®åœ°é‡å¯ï¼Œå°±ä¸æ€•åˆ«äººè¯´ï¼šâ€œä½ ä¸æ˜¯å­¦è®¡ç®—æœºçš„å—ï¼Œéš¾é“è¿˜ä¸ä¼šä¿®ç½‘ç»œï¼Ÿâ€çš„é—®é¢˜ã€‚<br/></p><p id="5d9961f3-6545-49f1-b082-8f05e8971337" class="">åœ¨è¯¾ç¨‹å­¦ä¹ çš„TCPçš„çŸ¥è¯†ä¹‹ä¸Šï¼Œæ„å»ºç²¾ç®€çš„TCPçš„æœ‰é™çŠ¶æ€æœºï¼Œå…¶åº”è¯¥èƒ½å¤Ÿå®ç°TCPçš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯é ä¼ è¾“ã€æ‹¥å¡æ§åˆ¶ã€è¶…æ—¶é‡ä¼ ç­‰ã€‚å¹¶ä½¿ç”¨æ„å»ºå‡ºçš„TCPæ¨¡å—è¿›è¡Œé€šä¿¡ï¼Œä½¿ç”¨wiresharkæŠ“åŒ…è·å–é€šä¿¡è¿‡ç¨‹ã€‚æ­¤å¤–å°†åŸºäºæ„å»ºå‡ºçš„TCPæ¨¡å—è¿›è¡Œæ‹“å±•æ¢ç©¶ã€‚</p><p id="90607f9f-9948-4c73-bd75-8431c45f910f" class="">æœ¬é¡¹ç›®åŸºäºStanford University CS144 2020 Fall çš„å®éªŒæŒ‡å¯¼ä¹¦ä»¥åŠå®éªŒå¹³å°ï¼Œå¹¶å‚é˜…RFCæ–‡æ¡£ä¸ã€Šè®¡ç®—æœºç½‘ç»œ-è‡ªé¡¶å‘ä¸‹æ–¹æ³•ã€‹ã€‚ç”±äºå®Œæ•´çš„å®éªŒæ˜¯ä¸€ä¸ªéå¸¸åºå¤§çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥åšäº†ä¸€äº›ç²¾ç®€ï¼Œåªé€‰æ‹©äº†å…³äºTCPçš„éƒ¨åˆ†(lab0-lab4)ï¼Œå…¶åŸºæœ¬æ¡†æ¶å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><figure id="b97eb51b-8906-4d5a-9e3f-3abab67e3330" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%201.png"><img style="width:912px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%201.png"/></a></figure><p id="9a37d6b4-c90c-4e86-9fb2-438dd0cddab7" class="">æ€»çš„æ¥è¯´ï¼Œæœ¬é¡¹ç›®å°†åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼Œå‰åŠéƒ¨åˆ†å°†æŒ‰ç…§CS144çš„å®éªŒæŒ‡å¯¼ä¹¦æ¥å®Œæˆæ„å»ºTCPåè®®æ ˆçš„è¦æ±‚ï¼ŒååŠéƒ¨åˆ†å°†åŸºäºæ„å»ºå‡ºæ¥çš„TCPåè®®æ ˆè¿›è¡Œæ¢ç©¶ï¼Œæ¢ç©¶å†…å®¹åŒ…æ‹¬é›¶çª—å£é—®é¢˜å·²ç»CS144ä¸­ç¼ºå¤±çš„TCPæ‹¥å¡æ§åˆ¶éƒ¨åˆ†ã€‚</p><h1 id="2794bc81-be96-4f16-aba5-5be23d7115a3" class="">TCP Header</h1><p id="18c15d88-ea86-4412-9835-e9bd385d11da" class="">è¿™æ˜¯æ‰€è¦ç”¨åˆ°çš„TCPé¦–éƒ¨çš„æ•°æ®ç»“æ„è®¾è®¡ï¼Œæ¥è‡ª<strong>RFC 9293</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="60190852-75c3-48ca-a702-30fa2fddadf4" class="code"><code class="language-C++">struct TCPHeader {
    static constexpr size_t LENGTH = 20; 
    //!   0                   1                   2                   3
    //!   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //!  |          Source Port          |       Destination Port        |
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //!  |                        Sequence Number                        |
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //!  |                    Acknowledgment Number                      |
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //!  |  Data |           |U|A|P|R|S|F|                               |
    //!  | Offset| Reserved  |R|C|S|S|Y|I|            Window             |
    //!  |       |           |G|K|H|T|N|N|                               |
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //!  |           Checksum            |         Urgent Pointer        |
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //!  |                    Options                    |    Padding    |
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //!  |                             data                              |
    //!  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    uint16_t sport = 0;         //!&lt; source port
    uint16_t dport = 0;         //!&lt; destination port
    WrappingInt32 seqno{0};     //!&lt; sequence number
    WrappingInt32 ackno{0};     //!&lt; ack number
    uint8_t doff = LENGTH / 4;  //!&lt; data offset
    bool urg = false;           //!&lt; urgent flag
    bool ack = false;           //!&lt; ack flag
    bool psh = false;           //!&lt; push flag
    bool rst = false;           //!&lt; rst flag
    bool syn = false;           //!&lt; syn flag
    bool fin = false;           //!&lt; fin flag
    uint16_t win = 0;           //!&lt; window size
    uint16_t cksum = 0;         //!&lt; checksum
    uint16_t uptr = 0;          //!&lt; urgent pointer
};</code></pre><h1 id="47aa9862-a0c1-4014-98f6-cba26f1f0e00" class="">TCP Receiver</h1><p id="540f0ba9-be40-411a-a7d7-582000241b22" class="">è¿™æ˜¯TCPçš„æ¥æ”¶æ–¹ï¼Œå…¶è¦å®Œæˆçš„å·¥ä½œæ˜¯å°†è¯»å…¥çš„æ•°æ®å†™å…¥è‡³ ByteStream ä¸­ï¼Œä»¥åŠå‘ŠçŸ¥TCPå‘é€æ–¹å®ƒçš„<strong>æ¥æ”¶çª—å£çš„å¤§å°</strong>ä»¥åŠ<strong>ä¸‹ä¸€ä¸ªæœŸæœ›æ¥æ”¶åˆ°çš„æŠ¥æ–‡çš„åºå·</strong>ã€‚åœ¨wiresharkæŠ“åŒ…ä¸­æ˜¾ç¤ºä¸º ack \ winã€‚</p><figure id="5ddafabd-e133-4d01-bd50-259ad9eab891" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%202.png"><img style="width:1553px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%202.png"/></a></figure><p id="73704e9e-6fcb-4d98-a5dc-2919fc507759" class="">éœ€è¦å®ç°ä¸€äº›ç±»æˆå‘˜å‡½æ•°ï¼š</p><ul id="91228810-fe71-45ee-9488-97ed348ec4c0" class="bulleted-list"><li style="list-style-type:disc">segment_received(): è¯¥å‡½æ•°å°†ä¼šåœ¨æ¯æ¬¡è·å–åˆ° TCP æŠ¥æ–‡æ—¶è¢«è°ƒç”¨ã€‚å¦‚æœæ¥æ”¶åˆ°äº† SYN åŒ…ï¼Œåˆ™è®¾ç½® ISN ç¼–å·ã€‚å°†è·å–åˆ°çš„æ•°æ®ä¼ å…¥æµé‡ç»„å™¨ï¼Œå¹¶åœ¨æ¥æ”¶åˆ° FIN åŒ…æ—¶ç»ˆæ­¢æ•°æ®ä¼ è¾“ã€‚</li></ul><ul id="860be36a-2a03-4b1a-b5eb-3963ac20e85b" class="bulleted-list"><li style="list-style-type:disc">ackno()ï¼šè¿”å›æ¥æ”¶æ–¹å°šæœªè·å–åˆ°çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„å­—èŠ‚ç´¢å¼•ã€‚å¦‚æœ ISN æš‚æœªè¢«è®¾ç½®ï¼Œåˆ™è¿”å›ç©ºã€‚</li></ul><ul id="312ecefe-5900-436f-9fbc-0fe6ed01ca10" class="bulleted-list"><li style="list-style-type:disc">window_size()ï¼šè¿”å›æ¥æ”¶çª—å£çš„å¤§å°ï¼Œå³ç¬¬ä¸€ä¸ªæœªç»„è£…çš„å­—èŠ‚ç´¢å¼•å’Œç¬¬ä¸€ä¸ªä¸å¯æ¥å—çš„å­—èŠ‚ç´¢å¼•ä¹‹é—´çš„é•¿åº¦ã€‚</li></ul><p id="64f71884-06f8-466b-85e4-2c805d4dd697" class="">åˆå§‹çŠ¶æ€ï¼š</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="58236e38-8104-440f-a003-9606134cfdf1" class="code"><code class="language-C++">#include &quot;tcp_receiver.hh&quot;

// Dummy implementation of a TCP receiver

// For Lab 2, please replace with a real implementation that passes the
// automated checks run by `make check_lab2`.

template &lt;typename... Targs&gt;
void DUMMY_CODE(Targs &amp;&amp;... /* unused */) {}

using namespace std;

bool TCPReceiver::segment_received(const TCPSegment &amp;seg) {
    DUMMY_CODE(seg);
    return {};
}

optional&lt;WrappingInt32&gt; TCPReceiver::ackno() const { return {}; }

size_t TCPReceiver::window_size() const { return {}; }</code></pre><p id="a8580027-9cbd-4ce5-9bdd-b6adda07d225" class="">åœ¨å®éªŒæŒ‡å¯¼ä¹¦ä¸­ç»™å‡ºäº†TCP Receiveråœ¨ç”Ÿå‘½å‘¨æœŸä¸­çš„æ¼”å˜è¿‡ç¨‹å›¾ï¼š</p><figure id="9dd291eb-ded8-469e-866a-1b67d07f93f3" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%203.png"><img style="width:816px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%203.png"/></a></figure><h3 id="94cd8732-b075-4e2a-b78d-800a17c596a8" class="">æ¥æ”¶æ–¹å¯¹äºæ¥æ”¶æŠ¥æ–‡çš„åˆ¤æ–­é€»è¾‘</h3><ul id="2ec15e16-4ee6-4da1-aef3-c6401617b66f" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœä¸æ˜¯åœ¨SYN-RECVçŠ¶æ€<ul id="debca271-f0f6-4beb-a18e-49c222b30ef2" class="bulleted-list"><li style="list-style-type:circle">æ”¶åˆ°çš„æŠ¥æ–‡å«synå­—æ®µï¼Œè¡¨ç¤ºæœ‰æ–°çš„è¿æ¥è¯·æ±‚ï¼Œæ­¤æ—¶è¿›å…¥SYN-RECVçŠ¶æ€ï¼Œå³SYN_flag è¢«è®¾ç½®ä¸º 1ï¼Œè®°å½•åˆå§‹åºåˆ—å· _isnï¼Œå¹¶åˆå§‹åŒ–åŸºåºå· _base ä¸º 1ã€‚å¦‚æœè¯¥ SYN æŠ¥æ–‡æ˜¯ç©ºçš„ï¼ˆå³åªåŒ…å« SYN å­—æ®µï¼‰ï¼Œåˆ™ä¸æ‰§è¡Œåç»­æ“ä½œã€‚</li></ul><ul id="4d238b03-4383-4b53-bd45-6883f8eb9bd0" class="bulleted-list"><li style="list-style-type:circle">æ”¶åˆ°çš„æŠ¥æ–‡ä¸å«synå­—æ®µï¼Œè¯´æ˜åœ¨æœªå»ºç«‹è¿æ¥çŠ¶æ€ä¸‹æ”¶åˆ°äº†é SYN æŠ¥æ–‡ï¼Œè¿™ç§æƒ…å†µä¸‹åº”è¯¥ä¸¢å¼ƒè¯¥æŠ¥æ–‡ã€‚</li></ul></li></ul><ul id="f776d8ed-27d5-4779-94ef-e16408f67606" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœå·²ç»åœ¨SYN-RECVçŠ¶æ€<ul id="1094be27-e6f1-448e-b3a6-be79ba8599b6" class="bulleted-list"><li style="list-style-type:circle">æ”¶åˆ°çš„æŠ¥æ–‡å«synå­—æ®µï¼Œä¸¢å¼ƒæŠ¥æ–‡ã€‚</li></ul><ul id="2ab10f53-c81d-47b3-a096-741ce1238ba5" class="bulleted-list"><li style="list-style-type:circle">æ”¶åˆ°çš„æŠ¥æ–‡ä¸å«synå­—æ®µï¼Œè¯´æ˜æ˜¯å·²å»ºç«‹è¿æ¥ä¸‹çš„æ™®é€šæ•°æ®æŠ¥æ–‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤„ç†å·²å»ºç«‹è¿æ¥çš„æ•°æ®æŠ¥æ–‡ã€‚å°†æŠ¥æ–‡çš„æœ‰æ•ˆéƒ¨åˆ†æ·»åŠ åˆ°ç¼“å†²åŒº _reassembler ä¸­ï¼Œé€šè¿‡è§£å°è£…è®¡ç®—ç»å¯¹åºåˆ—å· abs_seqnoã€‚å¤„ç†å¯èƒ½å­˜åœ¨çš„ FIN å­—æ®µï¼Œå¹¶æ ¹æ®æŠ¥æ–‡çš„åºåˆ—å·å’Œé•¿åº¦åˆ¤æ–­æ˜¯å¦åœ¨çª—å£èŒƒå›´å†…ã€‚å¦‚æœåœ¨çª—å£èŒƒå›´å†…ï¼Œåˆ™ç»§ç»­å¤„ç†ï¼›å¦åˆ™ä¸¢å¼ƒè¯¥æŠ¥æ–‡ã€‚ </li></ul></li></ul><h3 id="17dd3b28-bb11-4027-9d86-a96a31edbdf8" class="">ç¼“å†²åŒºå¤„ç† </h3><p id="d73a2f7e-081b-404d-b56d-31c3cc88c8f3" class="">TCPReceiver ä½¿ç”¨ _reassembler ç¼“å†²åŒºæ¥ä¿å­˜æ¥æ”¶åˆ°çš„æœ‰æ•ˆæ•°æ®éƒ¨åˆ†ã€‚ä»¥ä¸‹æ˜¯ç›¸å…³çš„è¡Œä¸ºï¼š</p><p id="e5a9771e-b9c5-4bba-a867-473300e70580" class="">å°†æœ‰æ•ˆéƒ¨åˆ†æ·»åŠ åˆ°ç¼“å†²åŒºï¼š é€šè¿‡è°ƒç”¨ _reassembler.push_substring æ–¹æ³•ï¼Œå°†æŠ¥æ–‡çš„æœ‰æ•ˆéƒ¨åˆ†æ·»åŠ åˆ°ç¼“å†²åŒºä¸­ï¼Œç»´æŠ¤ç›¸åº”çš„ç»å¯¹åºåˆ—å· abs_seqnoã€‚</p><p id="312f1cd3-5f38-4061-a668-c95435cc0ae5" class="">æ›´æ–°åŸºåºå· _baseï¼š æ ¹æ®ç¼“å†²åŒºçš„å¤´éƒ¨ç´¢å¼•ï¼Œæ›´æ–°åŸºåºå· _baseï¼Œä»¥ä¾¿åç»­çš„çª—å£èŒƒå›´åˆ¤æ–­ã€‚</p><p id="af9594e4-0c4c-4ed2-b029-7907b75b650c" class="">å¤„ç†è¾“å…¥ç»“æŸæƒ…å†µï¼š å¦‚æœç¼“å†²åŒºçš„è¾“å…¥ç»“æŸï¼Œå³ _reassembler.input_ended() è¿”å› trueï¼Œåˆ™æ›´æ–°åŸºåºå· _baseï¼Œå› ä¸º FIN å­—æ®µè¢«è§†ä¸ºä¸€ä¸ªå­—èŠ‚ã€‚</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8c042034-7eb3-427f-a141-1d5f18f8251c" class="code"><code class="language-C++">#include &quot;tcp_receiver.hh&quot;
// For Lab 2, please replace with a real implementation that passes the
// automated checks run by `make check_lab2`.
using namespace std;
bool TCPReceiver::segment_received(const TCPSegment &amp;seg) {
    static size_t abs_seqno = 0;
    size_t length;
    // å¦‚æœè¿æ¥å·²å»ºç«‹
    if (SYN_flag == 1) {
        if (seg.header().syn) {
            return false;  // å·²å»ºç«‹è¿æ¥æ—¶ä¸åº”è¯¥å†æ”¶åˆ°SYNæŠ¥æ–‡
        }
        // å¤„ç†å·²å»ºç«‹è¿æ¥çš„æŠ¥æ–‡
        abs_seqno = unwrap(WrappingInt32(seg.header().seqno.raw_value()), WrappingInt32(_isn), abs_seqno);
        length = seg.length_in_sequence_space();
        if (seg.header().fin) {
            if (FIN_flag == 1) {
                return false;  // å·²ç»æ”¶åˆ°è¿‡FINæŠ¥æ–‡ï¼Œä¸åº”å†æ”¶åˆ°
            } else {
                FIN_flag = 1;
            }
        } else {
            if (seg.length_in_sequence_space() == 0 &amp;&amp; abs_seqno == _base) {
                return true;  // æ”¶åˆ°ç©ºçš„æŠ¥æ–‡ï¼Œç›´æ¥è¿”å›
            } else if (abs_seqno &gt;= _base + window_size() || abs_seqno + length &lt;= _base) {
                return false;  // æŠ¥æ–‡ä¸åœ¨çª—å£èŒƒå›´å†…ï¼Œä¸¢å¼ƒ
            }
        }
    } else  
    {   // è¿˜æœªè¿›å…¥SYN-RECV
        if (!seg.header().syn) {
            return false;  // è¿˜æœªå»ºç«‹è¿æ¥ï¼Œä¸”æ”¶åˆ°çš„ä¸æ˜¯SYNæŠ¥æ–‡
        }
        SYN_flag = 1;
        _isn = seg.header().seqno.raw_value();
        abs_seqno = 1;
        _base = 1;
        length = seg.length_in_sequence_space() - 1;
        if (length == 0) {
            return true;  // ç©ºçš„SYNæŠ¥æ–‡ï¼Œç›´æ¥è¿”å›
        }
    }
    // å°†æŠ¥æ–‡çš„æœ‰æ•ˆéƒ¨åˆ†æ·»åŠ åˆ°ç¼“å†²åŒºä¸­
    _reassembler.push_substring(seg.payload().copy(), abs_seqno - 1, seg.header().fin);
    _base = _reassembler.head_index() + 1;
    if (_reassembler.input_ended()) {
        _base++;  // FINè¢«è§†ä¸ºä¸€ä¸ªå­—èŠ‚
    }
    return true;
}

optional&lt;WrappingInt32&gt; TCPReceiver::ackno() const {
    if (_base &gt; 0)
        return WrappingInt32(wrap(_base, WrappingInt32(_isn)));
    else
        return std::nullopt;
}
size_t TCPReceiver::window_size() const { 
		return _capacity - _reassembler.stream_out().buffer_size(); 
}</code></pre><h3 id="049c7a98-e630-41f1-89f3-0af9e640ae62" class="">æ€»ç»“TCP Receiver</h3><p id="c950efdd-f4e7-48be-b39c-e6c2b8064db8" class="">ä¸ºäº†å‡å°ä»»åŠ¡é‡ï¼ŒæŠŠåº•å±‚è¾ƒä¸ºå¤æ‚çš„å­—èŠ‚æµé‡ç»„é€»è¾‘é»‘ç®±åŒ–ï¼Œä½¿ç”¨åº•å±‚æä¾›çš„æ¥å£ï¼Œç€é‡å¯¹äºæ¥æ”¶åˆ°çš„TCPç‰‡æ®µçš„å¤„ç†ï¼Œç„¶åæ•´ä¸ªæ„å»ºæµç¨‹å°±æ˜¯å‡ ä¸ªifçš„åµŒå¥—è·³è½¬ã€‚</p><h1 id="61adeb8f-d6ef-49ff-a80c-773df3568b57" class="">TCP Sender</h1><p id="eb126699-4cf3-42c5-9ceb-9781c6fc9c04" class="">TCPçš„è®¸å¤šé‡è¦ç‰¹æ€§åœ¨è¿™é‡Œå®ç°ã€‚</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="a098b0f5-28a5-49ce-a685-3d457340437b"><div style="font-size:1.5em"><span class="icon">âš ï¸</span></div><div style="width:100%">è¿™æ˜¯å®éªŒæŒ‡å¯¼ä¹¦å¯¹æœ¬æ¨¡å—çš„è¦æ±‚ï¼š<p id="379afd9b-9b2e-4377-a2cf-1bb574ca56bf" class="">It will be your TCPSenderâ€™s responsibility to:</p><ul id="962f24cf-4676-4b11-ae1e-cbd74f0365d3" class="bulleted-list"><li style="list-style-type:disc">Keep track of the receiverâ€™s window (processing incoming acknos and window sizes)</li></ul><ul id="336b6710-0cd8-496e-87c0-be98d5342dae" class="bulleted-list"><li style="list-style-type:disc">Fill the window when possible, by reading from the ByteStream, creating new TCP segments (including SYN and FIN flags if needed), and sending them. The sender should keep sending segments until either the window is full or the ByteStream is empty.</li></ul><ul id="e445d728-b31d-4bd6-b1a2-9547f223d5b5" class="bulleted-list"><li style="list-style-type:disc">Keep track of which segments have been sent but not yet acknowledged by the receiver â€” we call these â€œoutstanding&quot; segments</li></ul><ul id="4874fa2c-0e70-4199-9b37-41a3c1d49f6e" class="bulleted-list"><li style="list-style-type:disc">Re-send outstanding segments if enough time passes since they were sent, and they havenâ€™t been acknowledged yet.</li></ul><p id="0b0e8114-0ee2-4b28-8870-db6a711c1b84" class="">Why am I doing this? The basic principle is to send whatever the receiver will allow us to send (filling the window), and keep retransmitting until the receiver acknowledges each segment. This is called â€œ<strong>automatic repeat request&quot; (ARQ).</strong> The sender divides the byte stream up into segments and sends them, as much as the receiverâ€™s window allows. Thanks to your work last week, we know that the remote TCP receiver can reconstruct the byte stream as long as it receives each index-tagged byte at least once|no matter the order. The senderâ€™s job is to make sure the receiver gets each byte at least once.</p></div></figure><p id="8792db4b-040a-4da9-b4d3-88ae5f31b214" class="">éœ€è¦ç”¨åˆ°çš„å‡ ä¸ªå‡½æ•°ï¼š</p><ul id="ee2259a9-a1a6-448b-9f30-ca5c3bed3aa0" class="bulleted-list"><li style="list-style-type:disc">fill_windowï¼šTCPSender ä» ByteStream ä¸­è¯»å–æ•°æ®ï¼Œå¹¶ä»¥ TCPSegement çš„å½¢å¼å‘é€ï¼Œå°½å¯èƒ½åœ°å¡«å……æ¥æ”¶è€…çš„çª—å£ã€‚</li></ul><ul id="0cc7aa8d-1924-44ba-af0c-ec36ab46a245" class="bulleted-list"><li style="list-style-type:disc">ack_receivedï¼šå¯¹æ¥æ”¶æ–¹è¿”å›çš„ ackno å’Œ window size è¿›è¡Œå¤„ç†ã€‚ä¸¢å¼ƒé‚£äº›å·²ç»å®Œå…¨ç¡®è®¤ä½†ä»ç„¶å¤„äºè¿½è¸ªé˜Ÿåˆ—çš„æ•°æ®åŒ…ã€‚åŒæ—¶å¦‚æœ window size ä»ç„¶å­˜åœ¨ç©ºé—²ï¼Œåˆ™ç»§ç»­å‘åŒ…ã€‚</li></ul><ul id="db4732cc-0432-472f-ac53-6d41bbdb5c49" class="bulleted-list"><li style="list-style-type:disc">tickï¼šè¯¥å‡½æ•°å°†ä¼šè¢«è°ƒç”¨ä»¥æŒ‡ç¤ºç»è¿‡çš„æ—¶é—´é•¿åº¦ã€‚å‘é€æ–¹å¯èƒ½éœ€è¦é‡æ–°å‘é€ä¸€äº›è¶…æ—¶ä¸”æ²¡æœ‰è¢«ç¡®è®¤çš„æ•°æ®åŒ…ã€‚</li></ul><ul id="4d9abd3f-6fa7-45e6-8e9f-bc1d0c67fe22" class="bulleted-list"><li style="list-style-type:disc">send_empty_segmentï¼šç”Ÿæˆå¹¶å‘é€ä¸€ä¸ªåœ¨ seq ç©ºé—´ä¸­é•¿åº¦ä¸º 0 å¹¶æ­£ç¡®è®¾ç½® seqno çš„ TCPSegmentï¼Œè¿™å¯è®©ç”¨æˆ·å‘é€ä¸€ä¸ªç©ºçš„ ACK æ®µã€‚</li></ul><p id="4bc109c7-53f1-4cd5-9012-a3af4749fdb3" class="">åˆå§‹çŠ¶æ€ï¼š</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1029788b-52c1-4581-9862-39df24e476d0" class="code"><code class="language-C++">#include &quot;tcp_sender.hh&quot;
#include &quot;tcp_config.hh&quot;
#include &lt;random&gt;
// Dummy implementation of a TCP sender
// For Lab 3, please replace with a real implementation that passes the
// automated checks run by `make check_lab3`.
template &lt;typename... Targs&gt;
void DUMMY_CODE(Targs &amp;&amp;... /* unused */) {}
using namespace std;

//! \param[in] capacity the capacity of the outgoing byte stream
//! \param[in] retx_timeout the initial amount of time to wait before retransmitting the oldest outstanding segment
//! \param[in] fixed_isn the Initial Sequence Number to use, if set (otherwise uses a random ISN)
TCPSender::TCPSender(const size_t capacity, const uint16_t retx_timeout, const std::optional&lt;WrappingInt32&gt; fixed_isn)
    : _isn(fixed_isn.value_or(WrappingInt32{random_device()()}))
    , _initial_retransmission_timeout{retx_timeout}
    , _stream(capacity) {}

uint64_t TCPSender::bytes_in_flight() const { return {}; }

void TCPSender::fill_window() {}

//! \param ackno The remote receiver&#x27;s ackno (acknowledgment number)
//! \param window_size The remote receiver&#x27;s advertised window size
//! \returns `false` if the ackno appears invalid (acknowledges something the TCPSender hasn&#x27;t sent yet)
bool TCPSender::ack_received(const WrappingInt32 ackno, const uint16_t window_size) {
    DUMMY_CODE(ackno, window_size);
    return {};
}
//! \param[in] ms_since_last_tick the number of milliseconds since the last call to this method
void TCPSender::tick(const size_t ms_since_last_tick) { DUMMY_CODE(ms_since_last_tick); }
unsigned int TCPSender::consecutive_retransmissions() const { return {}; }
void TCPSender::send_empty_segment() {}</code></pre><p id="8d566045-c899-4c04-9ba4-9ac0facac576" class="">ä¸‹é¢å°†åˆ†æ¨¡å—è¿›è¡Œæ„å»ºï¼š</p><h3 id="90de8e27-cd73-427f-931b-bcb90799fe3f" class="">è¶…æ—¶é‡ä¼ </h3><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="0103cfee-5177-4029-93a8-66a84d2294ac"><div style="font-size:1.5em"><span class="icon">âš ï¸</span></div><div style="width:100%">RFC 6298ä¸­æåˆ°ï¼š<p id="c277a520-a549-484e-a1a3-f078c5a68e25" class="">When the retransmission timer expires, do the following:</p><p id="0e93e509-415f-45e1-a325-542e798d9388" class="">(5.4) Retransmit the earliest segment that has not been acknowledged by the TCP receiver.</p><p id="d6a0d04e-f729-4edb-a4c1-625ec76c7016" class="">(5.5) The host MUST set RTO &lt;- RTO * 2 (&quot;back off the timer&quot;). The maximum value discussed in (2.5) above may be used to provide an upper bound to this doubling operation.</p><p id="342ead6a-243b-4298-b4c1-5604a38438b0" class="">(5.6) Start the retransmission timer, such that it expires after RTO seconds (for the value of RTO after the doubling operation outlined in 5.5).</p></div></figure><p id="117f6073-90ae-4b04-9c6b-292ad32d5f7a" class="">å³éœ€è¦åˆ›å»ºè®¡æ—¶å™¨Timer,è®°å½•æŠ¥æ–‡å‘å‡ºåç»å†çš„æ—¶é—´ï¼Œå¦‚æœæ—¶é—´è¶…è¿‡è®¾ç½®å¥½çš„RTOï¼Œå°±è¯´æ˜TCPå‘é€è¶…æ—¶ï¼Œè¿™æ—¶å°±é‡æ–°å‘é€è¯¥æŠ¥æ–‡ï¼Œå¹¶æ‰§è¡Œ<strong>æŒ‡æ•°é€€é¿</strong>ï¼Œå³ä½¿RTOå˜ä¸ºåŸæ¥2å€ã€‚ </p><p id="adf84aed-41aa-4e8f-a1a0-d0330eedb9c8" class="">ä»£ç å¦‚ä¸‹ï¼š</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ea1252ea-147d-48d8-af14-293c948784c8" class="code"><code class="language-C++">void TCPSender::tick(const size_t ms_since_last_tick)  // è¶…æ—¶é‡ä¼ 
{
    timer += ms_since_last_tick;
    if (timer &gt;= retransmission_timeout &amp;&amp; !SegmentsBuffer.empty())  // å‘ç°è¶…æ—¶
    {
        _segments_out.push(SegmentsBuffer.front());  // é‡æ–°å‘é€æŠ¥æ–‡
        retransmission_timeout *= 2;                 // æŒ‡æ•°å›é€€
        consecutive_retransmission++;                // è®°å½•è¿ç»­é‡ä¼ çš„æ¬¡æ•°
        timer_running = true;
        timer = 0;  // é‡æ–°è®¡æ—¶
    }
    if (SegmentsBuffer.empty())  // å‘é€å®Œæ¯•,å…³é—­å®šæ—¶å™¨
    {
        timer = 0;
        timer_running = false;
    }
}</code></pre><h3 id="eaaff2a1-76ce-453a-9733-18f04cff56b7" class="">åˆ°è¾¾ç¡®è®¤</h3><p id="ca68c6a0-8c65-4865-b2d5-b5f4fbc29e21" class="">æ¥æ”¶ç«¯æ¥æ”¶åˆ°åˆ†ç‰‡æ•°æ®æ—¶,æ ¹æ®åˆ†ç‰‡æ•°æ®åºå·å‘å‘é€ç«¯å‘é€ä¸€ä¸ªç¡®è®¤,å‘é€æ–¹ä¼šæ”¶åˆ°è¿™ä¸ªç¡®è®¤ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦æ¥å—è¿™ä¸ªç¡®è®¤ã€‚</p><p id="19acff21-f5e2-46bc-b290-b7955758172f" class="">æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š </p><ul id="37b1ca8e-37ff-4fc4-abad-924f203ea801" class="bulleted-list"><li style="list-style-type:disc">1.æ”¶åˆ°çš„ACKå¤§äºæœŸæœ›æ”¶åˆ°çš„ACKï¼Œè¿™æ—¶å°±ä¸¢å¼ƒè¿™ä¸ªç¡®è®¤ï¼Œé€€å‡ºè¯¥å‡½æ•° </li></ul><ul id="7246c05f-280d-4089-a579-5d181d46f996" class="bulleted-list"><li style="list-style-type:disc">2.æ”¶åˆ°çš„ACKå°äºæœŸæœ›æ”¶åˆ°çš„ACKï¼Œè¿™æ—¶è¯´æ˜åœ¨æ”¶åˆ°çš„ACKæ ‡å·ä¹‹å‰çš„æŠ¥æ–‡éƒ½æ­£ç¡®è¢«æ¥æ”¶æ–¹æ¥æ”¶äº†ï¼Œæ­¤æ—¶å‘é€æ–¹æ‰§è¡Œå¯¹å‘é€ç¼“å­˜çš„æ¸…ç†æ“ä½œï¼Œå°†å‘é€çª—å£è®¾ç½®ä¸ºæ¥æ”¶çª—å£çš„å¤§å°ï¼Œåˆå§‹åŒ–RTOï¼Œå¯¹è¿ç»­é‡ä¼ çš„è®¡æ•°å™¨è¿›è¡Œæ¸…é›¶ã€‚</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cf17cb2b-315e-4430-8e8d-e5703b7ca04d" class="code"><code class="language-C++">bool TCPSender::ack_received(const WrappingInt32 ackno, const uint16_t window_size) {
    size_t abs_ackno = unwrap(ackno, _isn, recv_ackno);
    if (abs_ackno &gt; _next_seqno)  // æ”¶åˆ°çš„ackæ¯”è¦æœŸå¾…æ¥æ”¶çš„ackè¿˜å¤§
    {
        return false;
    }
    if (abs_ackno &lt;= recv_ackno) { //æ”¶åˆ°çš„ackæ¯”è¦å·²ç»æ¥æ”¶è¿‡çš„ackè¿˜å°,è¯´æ˜å¯èƒ½æ˜¯è¿Ÿåˆ°çš„ç¡®è®¤
        return true;
    }
    recv_ackno = abs_ackno;
    // æ”¶åˆ°äº†å½“å‰ack,è¯´æ˜å½“å‰ackä¹‹å‰çš„æŠ¥æ–‡å·²ç»å…¨éƒ¨æ”¶åˆ°äº†,ä»å‘é€ç¼“å­˜ä¸­å¼¹å‡º
    while (!SegmentsBuffer.empty()) {
        TCPSegment seg = SegmentsBuffer.front();
        if (unwrap(seg.header().seqno, _isn, _next_seqno) + seg.length_in_sequence_space() &lt;= abs_ackno) {
            _bytes_in_flight -= seg.length_in_sequence_space();
            SegmentsBuffer.pop();
        } else
            break;
    }
    _window_size = window_size; //æ ¹æ®æ¥æ”¶æ–¹çš„çª—å£æ¥è°ƒæ•´å‘é€çª—å£
    retransmission_timeout = _initial_retransmission_timeout;  // é‡ç½®RTO
    consecutive_retransmission = 0;//é‡ä¼ æ¬¡æ•°å½’é›¶
    fill_window();
    if (!SegmentsBuffer.empty()) {
        timer_running = true;
        timer = 0;
    }
    return true;
}</code></pre><h3 id="fa65d7b8-1647-4971-94a3-4fc3fcf423d6" class="">æ»‘åŠ¨çª—å£</h3><p id="a6252420-86a5-451f-ab78-84cc314a3a2c" class="">åœ¨TCPSenderå’ŒTCPReceiveréƒ½ç»´æŠ¤ä¸€ä¸ªçª—å£ï¼Œåˆ†åˆ«ä¸ºå‘é€çª—å£å’Œæ¥æ”¶çª—å£ã€‚</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cf4dece4-932d-4578-a4ca-118c580f8037" class="code"><code class="language-C++">void TCPSender::fill_window(bool send_syn) {
    if (!SYN_flag) {
        if (send_syn) {
            TCPSegment seg;
            seg.header().syn = true;
            send_segment(seg);
            SYN_flag = true;
        }
        return;
    }
    // è®¾ç½®å½“å‰å‘é€çª—å£çš„å¤§å°
    size_t current_window_size = 0;
    if (_window_size == 0)  // å¦‚æœæ¥æ”¶æ–¹çš„çª—å£å¤§å°ä¸º0,åˆ™è®¾ç½®å‘é€çª—å£å¤§å°ä¸º1,å‘é€ç‰‡æ®µæ¥åˆ¤æ–­æ¥æ”¶æ–¹çª—å£æ˜¯å¦æ‰“å¼€
    {
        current_window_size = 1;
    } else
        current_window_size = _window_size;
    size_t remain = current_window_size - (_next_seqno - recv_ackno);  // å‘é€çª—å£å‰©ä½™å¤§å°
    while ((remain = current_window_size - (_next_seqno - recv_ackno)) != 0 &amp;&amp; !FIN_flag) {
        size_t size = min(TCPConfig::MAX_PAYLOAD_SIZE, remain);  // è®¾ç½®å‘é€è½½è·å¤§å°
        TCPSegment seg;
        string str = _stream.read(size);  // ä»å­—èŠ‚æµè·å–sizeå¤§å°çš„å­—ç¬¦ä¸²
        seg.payload() = Buffer(move(str));
        // å½“è¾“å…¥å­—èŠ‚æµåˆ°è¾¾eofä¸”çª—å£æœªå¡«æ»¡ï¼Œå¯è®¾ç½®å‘é€FIN
        if (seg.length_in_sequence_space() &lt; current_window_size &amp;&amp; _stream.eof()) {
            seg.header().fin = true;
            FIN_flag = true;
        }
        if (seg.length_in_sequence_space() == 0)  // å¦‚æœæ²¡æœ‰ä»»ä½•æ•°æ®ï¼Œåˆ™åœæ­¢æ•°æ®åŒ…çš„å‘é€
            return;
        send_segment(seg);
    }
}</code></pre><p id="3d8e7e71-aebc-4c89-be48-74069596fc3b" class=""><strong>å…³äºé›¶çª—å£é—®é¢˜ä»¥åŠæ‹¥å¡æ§åˆ¶å°†æ”¾åˆ°æœ€åè®¨è®ºã€‚</strong></p><p id="d2c12e26-d786-4cb8-ac90-41ee0957a3a5" class="">å®éªŒæŒ‡å¯¼ä¹¦ä¸Šçš„TCP Senderçš„ç”Ÿå‘½å‘¨æœŸï¼š</p><figure id="ee32d479-60bb-4e07-b99a-ed200f08e1ce" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%204.png"><img style="width:720px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%204.png"/></a></figure><p id="d028d64b-cabb-4fd6-b978-2f8ae311ecaf" class="">
</p><h3 id="2f6d9c3b-8cf0-4c68-bc0b-8f1e166614b3" class="">ä¸€äº›å˜é‡</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2fcf8109-b4d8-4bf7-9137-136fad5ac6f6" class="code"><code class="language-C++">class TCPSender {
  private:
    //! our initial sequence number, the number for our SYN.
    WrappingInt32 _isn;
    //! outbound queue of segments that the TCPSender wants sent
    std::queue&lt;TCPSegment&gt; _segments_out{};
    //! retransmission timer for the connection
    unsigned int _initial_retransmission_timeout;//åˆå§‹çš„RTO
    bool SYN_flag=false; //æ˜¯å¦å·²ç»å‘é€è¿‡SYN
    bool FIN_flag=false; //æ˜¯å¦å·²ç»å‘é€è¿‡FIN 
    size_t _window_size=0; //å‘é€çª—å£å¤§å°
    size_t recv_ackno=0; //æœ€è¿‘ä¸€æ¬¡æ”¶åˆ°çš„ack
    uint64_t _bytes_in_flight = 0;
    size_t timer=0; //è®¡æ—¶å™¨
    bool timer_running=false;//è®¡æ—¶å™¨æ˜¯å¦å¼€å§‹å·¥ä½œ
    size_t retransmission_timeout;//å½“å‰çš„RTO
    size_t consecutive_retransmission=0;//è¿ç»­é‡ä¼ çš„æ•°ç›®
    std::queue&lt;TCPSegment&gt; SegmentsBuffer{};//ç­‰å¾…å‘é€çš„ç‰‡æ®µ
		........
}</code></pre><h1 id="976e624e-947d-4a4e-a618-f87786c27bc7" class="">TCP Connection</h1><p id="5f0da6f5-bf5d-453f-8461-4c71543d1efc" class="">TCPConnection éœ€è¦å°† TCPSender å’Œ TCPReceiver ç»“åˆï¼Œå®ç°æˆä¸€ä¸ª TCP ç»ˆç«¯ï¼ŒåŒæ—¶æ”¶å‘æ•°æ®ã€‚</p><p id="5bc7d4d5-0d1e-414e-824f-ffe3f78f28b8" class="">æ˜¯ä¸€ä¸ªç›¸å½“æŠ˜ç£¨çš„è¿‡ç¨‹ã€‚å› ä¸ºä¹‹å‰çš„TCP Senderå’ŒTCP Receiverçš„æµ‹è¯•æ ·ä¾‹å¹¶ä¸å¤Ÿå…¨é¢ï¼Œè®¾è®¡çš„æ—¶å€™é²æ£’æ€§ç›¸å½“çš„å·®ï¼Œæ‰€ä»¥åœ¨å°†ä»–ä»¬è¿æ¥èµ·æ¥åä¼šå‡ºç°å„ç§é—®é¢˜ï¼Œåˆ°å¤„ç¼ç¼è¡¥è¡¥ä¿®ç†bugã€‚</p><figure id="88687cb4-08b8-43f2-8275-641bab5a2647" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%205.png"><img style="width:816px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%205.png"/></a></figure><p id="d54887a4-ed38-4298-bd92-bb5a7aeb30b8" class=""><strong>TCPåè®®æ ˆç”±æ¥æ”¶å™¨å’Œå‘é€å™¨ç»„æˆ,TCPè¿æ¥ç”Ÿå‘½å‘¨æœŸæ‰€æœ‰çŠ¶æ€å¦‚ä¸‹é¢caseæšä¸¾çš„çŠ¶æ€æ‰€ç¤ºï¼š</strong></p><p id="dbe65141-c92d-41f0-96a0-9cf4f93b9781" class=""><strong>æ¯ä¸ªçŠ¶æ€ç”±ä¸€ç»„æ¥æ”¶å™¨å’Œå‘é€å™¨çŠ¶æ€ç»„æˆ</strong></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1accf33b-c875-4d9b-ba5e-d953452657a2" class="code"><code class="language-C++">TCPState::TCPState(const TCPState::State state) {
    switch (state) {
        case TCPState::State::LISTEN:
            _receiver = TCPReceiverStateSummary::LISTEN;
            _sender = TCPSenderStateSummary::CLOSED;
            break;
        case TCPState::State::SYN_RCVD:
            _receiver = TCPReceiverStateSummary::SYN_RECV;
            _sender = TCPSenderStateSummary::SYN_SENT;
            break;
        case TCPState::State::SYN_SENT:
            _receiver = TCPReceiverStateSummary::LISTEN;
            _sender = TCPSenderStateSummary::SYN_SENT;
            break;
        case TCPState::State::ESTABLISHED:
            _receiver = TCPReceiverStateSummary::SYN_RECV;
            _sender = TCPSenderStateSummary::SYN_ACKED;
            break;
        case TCPState::State::CLOSE_WAIT:
            _receiver = TCPReceiverStateSummary::FIN_RECV;
            _sender = TCPSenderStateSummary::SYN_ACKED;
            _linger_after_streams_finish = false;
            break;
        case TCPState::State::LAST_ACK:
            _receiver = TCPReceiverStateSummary::FIN_RECV;
            _sender = TCPSenderStateSummary::FIN_SENT;
            _linger_after_streams_finish = false;
            break;
        case TCPState::State::CLOSING:
            _receiver = TCPReceiverStateSummary::FIN_RECV;
            _sender = TCPSenderStateSummary::FIN_SENT;
            break;
        case TCPState::State::FIN_WAIT_1:
            _receiver = TCPReceiverStateSummary::SYN_RECV;
            _sender = TCPSenderStateSummary::FIN_SENT;
            break;
        case TCPState::State::FIN_WAIT_2:
            _receiver = TCPReceiverStateSummary::SYN_RECV;
            _sender = TCPSenderStateSummary::FIN_ACKED;
            break;
        case TCPState::State::TIME_WAIT:
            _receiver = TCPReceiverStateSummary::FIN_RECV;
            _sender = TCPSenderStateSummary::FIN_ACKED;
            break;
        case TCPState::State::RESET:
            _receiver = TCPReceiverStateSummary::ERROR;
            _sender = TCPSenderStateSummary::ERROR;
            _linger_after_streams_finish = false;
            _active = false;
            break;
        case TCPState::State::CLOSED:
            _receiver = TCPReceiverStateSummary::FIN_RECV;
            _sender = TCPSenderStateSummary::FIN_ACKED;
            _linger_after_streams_finish = false;
            _active = false;
            break;
    }
}</code></pre><p id="40984c39-a9fc-456a-8693-736b672a0bad" class="">TCPConnection æœ‰å‡ ä¸ªè§„åˆ™éœ€è¦éµå®ˆï¼š</p><p id="30c1106f-5c62-4b0e-9f69-06212cdfb087" class="">å¯¹äºæ¥æ”¶æ•°æ®ç«¯è€Œè¨€ï¼š</p><ul id="e14b64a6-6b52-4023-ac20-1368b75541e4" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœæ¥æ”¶åˆ°çš„æ•°æ®åŒ…è®¾ç½®äº† RST æ ‡å¿—ï¼Œåˆ™å°†è¾“å…¥è¾“å‡ºå­—èŠ‚æµå…¨éƒ¨è®¾ç½®ä¸º é”™è¯¯ çŠ¶æ€ï¼Œå¹¶æ°¸ä¹…å…³é—­ TCP è¿æ¥ã€‚</li></ul><ul id="493d4936-0bf4-48e4-8eb6-cafefae71423" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœæ²¡æœ‰æ”¶åˆ° RST æ ‡å¿—ï¼Œåˆ™å°†è¯¥æ•°æ®åŒ…ä¼ è¾¾ç»™ TCPReceiver æ¥å¤„ç†ï¼Œå®ƒå°†å¯¹æ•°æ®åŒ…ä¸­çš„ seqnoã€SYNã€payloadã€FIN è¿›è¡Œå¤„ç†ã€‚</li></ul><ul id="7f1735ac-a5b6-441d-9218-bc9cccf7b89e" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœæ¥æ”¶åˆ°çš„æ•°æ®åŒ…ä¸­è®¾ç½®äº† ACK æ ‡å¿—ï¼Œåˆ™å‘å½“å‰ TCPConnection ä¸­å®ƒè‡ªå·±çš„ TCPSender å‘ŠçŸ¥è¿œç¨‹ç»ˆç«¯çš„ ackno å’Œ window_sizeã€‚</li></ul><ul id="7c636992-f49a-4d95-b4ff-9c23d2bb55a1" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœæ¥æ”¶åˆ°çš„ TCP æ•°æ®åŒ…åŒ…å«äº†ä¸€ä¸ªæœ‰æ•ˆ seqnoï¼Œåˆ™ TCPConnection å¿…é¡»è‡³å°‘è¿”å›ä¸€ä¸ª TCP åŒ…ä½œä¸ºå›å¤ï¼Œä»¥å‘ŠçŸ¥è¿œç¨‹ç»ˆç«¯ æ­¤æ—¶çš„ ackno å’Œ window sizeã€‚</li></ul><ul id="c1b1538e-4d91-4cfc-885f-8deedb20715a" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœæ¥æ”¶åˆ°çš„ TCP æ•°æ®åŒ…åŒ…å«çš„ seqno æ˜¯æ— æ•ˆçš„ï¼Œåˆ™ TCPConnection ä¹Ÿéœ€è¦å›å¤ä¸€ä¸ªæ— æ•ˆæ•°æ®åŒ…ã€‚è¿™æ˜¯å› ä¸ºè¿œç¨‹ç»ˆç«¯å¯èƒ½ä¼šå‘é€æ— æ•ˆæ•°æ®åŒ…ä»¥ç¡®è®¤å½“å‰è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼ŒåŒæ—¶æŸ¥çœ‹æ­¤æ—¶æ¥æ”¶æ–¹çš„ ackno å’Œ window sizeã€‚è¿™è¢«ç§°ä¸º TCP çš„ keep-aliveæœºåˆ¶ã€‚</li></ul><p id="1dc89066-2755-46c0-bf28-d105de446dac" class="">å¯¹äºå‘é€æ•°æ®ç«¯æ¥è¯´ï¼š</p><ul id="acf57c04-88b7-4fd9-9072-692af47385c3" class="bulleted-list"><li style="list-style-type:disc">å½“ TCPSender å°†ä¸€ä¸ª TCPSegment æ•°æ®åŒ…æ·»åŠ åˆ°å¾…å‘é€é˜Ÿåˆ—ä¸­æ—¶ï¼ŒTCPConnection éœ€è¦ä»ä¸­å–å‡ºå¹¶å°†å…¶å‘é€ã€‚</li></ul><ul id="c7b398d8-cabb-45ef-8a9c-3263b304d424" class="bulleted-list"><li style="list-style-type:disc">åœ¨å‘é€å½“å‰æ•°æ®åŒ…ä¹‹å‰ï¼ŒTCPConnection ä¼šè·å–å½“å‰å®ƒè‡ªå·±çš„ TCPReceiver çš„ ackno å’Œ window sizeï¼Œå°†å…¶æ”¾ç½®è¿›å¾…å‘é€ TCPSegment ä¸­ï¼Œå¹¶è®¾ç½®å…¶ ACK æ ‡å¿—ã€‚</li></ul><p id="4a967134-71b3-4b99-92f9-0d0f53d3dc52" class="">å½“ TCPConnection çš„ tick å‡½æ•°è¢«è°ƒç”¨åï¼Œå®ƒéœ€è¦</p><ul id="27bcc0cf-4f56-4022-a176-ff00f548cdcf" class="bulleted-list"><li style="list-style-type:disc">å‘ŠçŸ¥ TCPSender æ—¶é—´çš„æµé€ï¼Œè¿™å¯èƒ½ä¼šè®© TCPSender é‡æ–°å‘é€è¢«ä¸¢å¼ƒçš„æ•°æ®åŒ…</li></ul><ul id="f341e21c-19ac-4aea-8091-f00cbc56b1d0" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœè¿ç»­é‡ä¼ æ¬¡æ•°è¶…è¿‡ TCPConfig::MAX RETX ATTEMPTSï¼Œåˆ™å‘é€ä¸€ä¸ª RST åŒ…ã€‚</li></ul><ul id="9ad66594-c154-4843-9e5a-89e227162a68" class="bulleted-list"><li style="list-style-type:disc">åœ¨æ¡ä»¶é€‚åˆçš„æƒ…å†µä¸‹å…³é—­ TCP è¿æ¥ï¼ˆå½“å¤„äº TCP çš„ TIME_WAIT çŠ¶æ€æ—¶ï¼‰ã€‚<br/><br/></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="666e2a12-59eb-403a-9366-cd76d209a39d" class="code"><code class="language-C++">#include &quot;tcp_connection.hh&quot;
#include &lt;iostream&gt;
// For Lab 4, please replace with a real implementation that passes the
// automated checks run by `make check`.
using namespace std;
// å‘é€çª—å£å‰©ä½™ç©ºé—´
size_t TCPConnection::remaining_outbound_capacity() const { return _sender.stream_in().remaining_capacity(); }
// å·²å‘é€ï¼Œä½†æ˜¯è¿˜æœªæ”¶åˆ°ackçš„å­—èŠ‚æ•°
size_t TCPConnection::bytes_in_flight() const { return _sender.bytes_in_flight(); }
// æœªæŒ‰åºåˆ°è¾¾çš„å­—èŠ‚æ•°
size_t TCPConnection::unassembled_bytes() const { return _receiver.unassembled_bytes(); }
// ä¸Šä¸€æ¬¡æ”¶åˆ°æŠ¥æ–‡ç»è¿‡çš„æ—¶é—´
size_t TCPConnection::time_since_last_segment_received() const { return _time_since_last_segment_received; }
// å½“å‰TCPæ˜¯å¦è¿˜active
bool TCPConnection::active() const { return _active; }
// æ¥æ”¶TCPæ•°æ®æŠ¥
void TCPConnection::segment_received(const TCPSegment &amp;seg) {
    if (!_active)
        return;
    _time_since_last_segment_received = 0;
    //æ”¶åˆ°RSTç›´æ¥å¼‚å¸¸ç»ˆæ­¢
    if (seg.header().rst) {
        unclean_shutdown(false);
        return;
    }
    //SYN_SENTçŠ¶æ€ä¸èƒ½æ”¶åˆ°å¸¦æœ‰æ•°æ®è½½è·çš„ack
    if (TCPState::state_summary(_sender) == TCPSenderStateSummary::SYN_SENT 
        &amp;&amp; seg.header().ack &amp;&amp; seg.payload().size() &gt; 0) 
    {
        return;
    }
    bool send_empty = false;
    //æ”¶åˆ°ACKåŒ…ï¼Œæ›´æ–°senderçš„çŠ¶æ€
    if (_sender.next_seqno_absolute() &gt; 0 &amp;&amp; seg.header().ack) {
        if (!_sender.ack_received(seg.header().ackno, seg.header().win)) {
            send_empty = true;
        }
    }
    //æ¥æ”¶æ–¹æ¥æ”¶æŠ¥æ–‡
    bool recv_flag = _receiver.segment_received(seg);
    if (!recv_flag) {
        send_empty = true;
    }
    // æ¥æ”¶å™¨åˆæ¬¡æ¥æ”¶åˆ°SYNåŒ…,å¹¶ä¸”æ­¤æ—¶å‘é€å™¨è¿˜å¤„äºå…³é—­çŠ¶æ€,æ‰€ä»¥å½“å‰ç”±LISTENè½¬ä¸ºäº†SYN_SENTçŠ¶æ€
    if (TCPState::state_summary(_receiver) == TCPReceiverStateSummary::SYN_RECV &amp;&amp;
        TCPState::state_summary(_sender) == TCPSenderStateSummary::CLOSED) {
        connect();
        return;
    }
    if (seg.length_in_sequence_space() &gt; 0) {
        send_empty = true;
    }
    //éœ€è¦keep-alive
    if (send_empty &amp;&amp; TCPState::state_summary(_receiver) != TCPReceiverStateSummary::LISTEN) {
        _sender.send_empty_segment();
    }
    send_segments();
}

size_t TCPConnection::write(const string &amp;data) {
    size_t write_size = _sender.stream_in().write(data);  // å‘å†™å…¥ç¼“å†²å†™å…¥æ•°æ®
    send_segments();
    return write_size;
}

//! \param[in] ms_since_last_tick number of milliseconds since the last call to this method
void TCPConnection::tick(const size_t ms_since_last_tick) {
    if (!_active)
        return;
    _time_since_last_segment_received += ms_since_last_tick;
    _sender.tick(ms_since_last_tick);
    // é‡ä¼ æ¬¡æ•°å¤ªå¤šæ—¶éœ€è¦æ–­å¼€è¿æ¥
    if (_sender.consecutive_retransmissions() &gt; TCPConfig::MAX_RETX_ATTEMPTS) {
        unclean_shutdown(true);
    }
    send_segments();
}

void TCPConnection::end_input_stream() {
    // å…³é—­å‘é€ç«¯çš„å†™å…¥é€šé“
    _sender.stream_in().end_input();
    send_segments();
}

void TCPConnection::connect() {
    // å»ºç«‹è¿æ¥
    send_segments(true);
}

TCPConnection::~TCPConnection() {
    try {
        // å¦‚æœTCPè¿æ¥æ˜¯æ´»è·ƒçŠ¶æ€åˆ™å…³é—­è¿æ¥
        if (active()) {
            cerr &lt;&lt; &quot;Warning: Unclean shutdown of TCPConnection\n&quot;;
            unclean_shutdown(true);
        }
    } catch (const exception &amp;e) {
        std::cerr &lt;&lt; &quot;Exception destructing TCP FSM: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;
    }
}
// å°†å¾…å‘é€çš„æ•°æ®åŒ…åŠ ä¸ŠæœŸæœ›æ¥å—åˆ°æ•°æ®çš„acknoå’Œå½“å‰è‡ªå·±ä½œä¸ºæ¥æ”¶ç«¯çš„æ»‘åŠ¨çª—å£å¤§å°
bool TCPConnection::send_segments(bool send_syn) {
    _sender.fill_window(send_syn || TCPState::state_summary(_receiver) == TCPReceiverStateSummary::SYN_RECV);
    TCPSegment seg;
    while (!_sender.segments_out().empty()) {
        // ä»å‘é€ç«¯çš„ä¼ è¾“é˜Ÿåˆ—å–å‡ºè¦å‘é€çš„TCPæ•°æ®æŠ¥
        seg = _sender.segments_out().front();
        _sender.segments_out().pop();
        if (_receiver.ackno().has_value()) {  // åˆ¤æ–­å½“å‰æ˜¯å¦å¤„äºLISTENçŠ¶æ€
            // å‘æ¥æ”¶æ–¹å‘é€ACK/ä¸‹ä¸€ä¸ªæœŸæœ›æ”¶åˆ°çš„ackno/å½“å‰æ¥æ”¶çª—å£å¤§å°
            seg.header().ack = true;
            seg.header().ackno = _receiver.ackno().value();
            seg.header().win = _receiver.window_size();
        }
        // å‡ºç°å¼‚å¸¸è®¾ç½®RSTä½
        if (_need_send_rst) {
            _need_send_rst = false;
            seg.header().rst = true;
        }
        _segments_out.push(seg);
    }
    clean_shutdown();
    return true;
}
// å‡ºç°å¼‚å¸¸ç»“æŸè¿æ¥
void TCPConnection::unclean_shutdown(bool send_rst) {
    _receiver.stream_out().set_error();
    _sender.stream_in().set_error();
    _active = false;
    if (send_rst) {
        _need_send_rst = true;
        if (_sender.segments_out().empty()) {
            _sender.send_empty_segment();
        }
        send_segments();
    }
}
// æ­£å¸¸ç»“æŸè¿æ¥
bool TCPConnection::clean_shutdown() {
    if (_receiver.stream_out().input_ended() &amp;&amp; !(_sender.stream_in().eof())) {
        _linger_after_streams_finish = false;
    }
    if (TCPState::state_summary(_receiver) == TCPReceiverStateSummary::FIN_RECV &amp;&amp;
        TCPState::state_summary(_sender) == TCPSenderStateSummary::FIN_ACKED) {
        if (!_linger_after_streams_finish || time_since_last_segment_received() &gt;= 10 * _cfg.rt_timeout) {
            // ç­‰å¾…2MSL
            _active = false;
        }
    }
    return !_active;
}</code></pre><p id="40ca84a5-c2bb-4e76-b316-326c4b233b55" class="">åˆ°è¿™é‡Œä¸ºæ­¢åŸºæœ¬ä¸Šå®Œæˆäº†å®éªŒæŒ‡å¯¼ä¹¦çš„è¦æ±‚ï¼Œæ„å»ºå‡ºäº†å¯ä»¥ä½¿ç”¨çš„TCPåè®®æ ˆã€‚</p><h1 id="3620ce5a-bb00-4a88-8b86-fe4c004c0305" class="">æ›¿æ¢æ‰Linuxçš„TCPæ ˆï¼Œä½¿ç”¨ä»¥ä¸Šæ„å»ºçš„TCPåè®®æ ˆè¿›è¡Œé€šä¿¡</h1><ul id="32b49f76-b523-4cb6-88d9-92a3f97aa970" class="bulleted-list"><li style="list-style-type:disc">ä¿®æ”¹webget.ccï¼Œä»Linuxçš„TCPåè®®æ ˆåˆ‡æ¢åˆ°ä»¥ä¸Šæ„å»ºçš„åè®®æ ˆ</li></ul><figure id="fcacb27c-eddf-4e83-82d3-e6bc2632b480" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%206.png"><img style="width:912px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%206.png"/></a></figure><p id="b7009afe-c6fc-41b8-939e-a5ea7c4698f9" class="">æˆåŠŸè·å–äº†baidu.comç½‘é¡µä¸Šçš„ä¿¡æ¯ã€‚</p><p id="797c1fcd-b48a-4868-8e50-76f3a22e76c3" class="">
</p><ul id="4c3ce753-e05f-475a-8d12-00aa8ea745ca" class="bulleted-list"><li style="list-style-type:disc">å®éªŒå¹³å°æä¾›äº†tcp_ipv4.ccæ–‡ä»¶ï¼Œå…¶ä½¿ç”¨äº†ä»¥ä¸Šæ„ç­‘çš„TCPåè®®æ ˆæ¥è¿›è¡Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„é€šä¿¡ã€‚è™šæ‹Ÿå‡ºäº†tun144å’Œtun145ä¸¤å—ç½‘å¡è¿›è¡Œé€šä¿¡ã€‚</li></ul><figure id="21b22f83-caeb-4edb-9521-6e36da17ae1f" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%207.png"><img style="width:2560px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%207.png"/></a><figcaption>ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥</figcaption></figure><figure id="ba5298d8-a4a1-4c7e-85b1-e58ff7aba6a7" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%208.png"><img style="width:2560px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%208.png"/></a><figcaption>è¿›è¡Œé€šä¿¡</figcaption></figure><figure id="0f45afa3-eb8f-4837-87b5-ba8eaedb3244" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%209.png"><img style="width:2560px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%209.png"/></a><figcaption>å››æ¬¡æŒ¥æ‰‹æ–­å¼€è¿æ¥</figcaption></figure><h1 id="06172548-fcb9-41d6-b25d-6ea9a25817d3" class="">Whatâ€™s More?</h1><p id="37c57cc8-828a-418f-901b-b3e8bf43833c" class="">ä»¥ä¸Šæ˜¯CS144è¯¾ç¨‹çš„Lab0~Lab4çš„å®éªŒè¦æ±‚ã€‚ä»£ç å¯ä»¥é€šè¿‡å…¶æ‰€æœ‰çš„æµ‹è¯•æ ·ä¾‹ã€‚åˆ°æ­¤ä¸ºæ­¢å·²ç»æˆåŠŸæ„å»ºèµ·äº†èƒ½å¤Ÿç”¨äºé€šä¿¡çš„TCPåè®®æ ˆã€‚</p><p id="c845358c-f756-4dfc-a616-9ed76b431c59" class="">åœ¨è¯¥å¹³å°ä¹‹ä¸Šå¯ä»¥è¿›è¡Œæ‹“å±•ï¼Œå®ç°è‡ªå·±éœ€è¦çš„ä¸€äº›åŠŸèƒ½ã€‚</p><p id="77acff77-3160-45c7-bab7-e520a16367e0" class="">æˆ‘è®¾è®¡æ¢ç©¶çš„æ˜¯<strong>é›¶çª—å£é—®é¢˜</strong>å’Œ<strong>TCPçš„æ‹¥å¡æ§åˆ¶è¿‡ç¨‹</strong>ã€‚</p><hr id="59424898-03f5-4df5-acc3-e38dbd43595f"/><blockquote id="741b193e-b47c-4f42-af08-1190a9562975" class="">è¯´æ˜ï¼šä»¥ä¸‹å†…å®¹ä¸CS144å®éªŒæ— å…³ï¼Œä¸ºä»¥ä¸‹å†…å®¹è€Œä¿®æ”¹çš„ä»£ç æ— æ³•å®Œç¾é€šè¿‡CS144çš„å…¨éƒ¨æµ‹è¯•æ ·ä¾‹</blockquote><hr id="dbf33073-d9e7-4e91-9498-b9143ee9dc73"/><h1 id="c811005e-8935-46dd-bb60-ee4205123522" class="">é›¶çª—å£é—®é¢˜</h1><p id="bd4b3832-8383-415b-8831-9237cffa4b09" class="">ç‰¹åˆ«åœ°ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ª<strong>é›¶çª—å£é—®é¢˜(Zero Window)</strong> ,å³TCPReceiverçš„æ¥æ”¶çª—å£å¤§å°ä¸º0ï¼Œæ­¤æ—¶æŒ‰ç…§å¸¸è§„é€»è¾‘ï¼ŒTCPSenderä¸ä¼šå‘é€æŠ¥æ–‡ï¼Œä»è€Œæ— æ³•è·å–æ¥æ”¶çª—å£çš„çŠ¶æ€ï¼Œé€ æˆæ­»é”ã€‚</p><p id="686ee174-f256-45a6-85d5-aaa6ecc2c6d5" class="">äºæ˜¯éœ€è¦è®¾è®¡ä¸€ä¸ªæ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p id="9a9cfbff-dca1-41ed-bf8b-d254d0ae46e7" class="">åœ¨CS144å®éªŒä¸­ï¼Œå®éªŒæŒ‡å¯¼ä¹¦è¦æ±‚å½“å‘é€çª—å£ä¸º0æ—¶è®¾ç½®å‘é€çª—å£ä¸º1ï¼š</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="594926d5-b783-496e-b115-3a7e9385cad2"><div style="font-size:1.5em"><span class="icon">âš ï¸</span></div><div style="width:100%">What should I do if the window size is zero? If the receiver has announced a window size of zero, <strong>the fill window method should act like the window size is one. </strong>The sender might end up sending a single byte that gets rejected (and not acknowledged) by the receiver, but this can also provoke the receiver into sending a new acknowledgment segment where it reveals that more space has opened up in its window. Without this, the sender would never learn that it was allowed to start sending again.</div></figure><p id="c848e492-5523-4023-88c9-8a43df546828" class="">æŸ¥é˜…èµ„æ–™ï¼Œæˆ‘äº†è§£åˆ°TCPæœ‰ä¸€ä¸ªé›¶çª—å£è®¡æ—¶å™¨ï¼Œäºæ˜¯æˆ‘è®¾è®¡äº†ä¸€ä¸ª<strong>é›¶çª—å£è®¡æ—¶å™¨</strong>ï¼Œç”¨äºç»Ÿè®¡é›¶çª—å£ç»å†çš„æ—¶é•¿ï¼Œå¦‚æœè®¡æ—¶å™¨è¶…æ—¶ï¼Œåˆ™å‘TCPæ¥æ”¶æ–¹å‘é€1å­—èŠ‚çš„æ¢æµ‹æŠ¥æ–‡ã€‚</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="07e5268a-17d2-42b9-9050-6f178a51f04a" class="code"><code class="language-C++">...
	size_t ZeroWindow_timer=0;
	bool ZeroWindow_timer_running=false;
	size_t DetectWindow_timeout=10;</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4d916f49-5472-4089-88d9-293589527efd" class="code"><code class="language-C++">//è®¾ç½®å½“å‰å‘é€çª—å£çš„å¤§å°
	size_t current_window_size=0;
	if(_window_size==0)//æ¥æ”¶æ–¹çª—å£å¤§å°ä¸º0
	{
			if(ZeroWindow_timer_running==false)
			{
					ZeroWindow_timer=get_time_ms();
					ZeroWindow_timer_running=true;
			}
			else
			{
					ZeroWindow_timer=get_time_ms()-ZeroWindow_timer;
					if(ZeroWindow_timer &gt; DetectWindow_timeout)
					{
							current_window_size = 1;
					}
			}
	}
	else
	{
			current_window_size = _window_size;
	}</code></pre><p id="4aa345ef-2c00-4892-bd5a-079902bf8d8c" class="">äºæ˜¯å°±æœ‰äº†å¯¹è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚å½“TCPSenderæ”¶åˆ°TCPReceiverçš„å›åº”ï¼Œå°±å¯ä»¥æ ¹æ®å½“å‰çš„æ¥å—çª—å£å¤§å°æ¥å¯¹å‘é€çª—å£è¿›è¡Œè°ƒæ•´ã€‚</p><figure id="3a263bcd-7dd1-4e2a-bd74-13ce45955488" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2010.png"><img style="width:528px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2010.png"/></a></figure><p id="7b8db410-f339-493f-bcf5-2898147c81c7" class="">ç”±äºè‡ªå·±è®¾è®¡çš„æ–¹æ³•ä¸å®éªŒè¦æ±‚ä¸å¤§ç¬¦åˆï¼Œæµ‹è¯•æ ·ä¾‹æ¶ˆè€—æ—¶é—´æ˜¾è‘—å¢åŠ ã€‚</p><p id="0adb08f8-e79c-40e2-8ae2-6cfe0acf5aaf" class="">ä»¥ä¸‹æ˜¯äººä¸ºè®¾ç½®çš„é›¶çª—å£çŠ¶æ€è§‚å¯Ÿï¼Œå…¶åŸç†æ˜¯åœ¨è¿è¡Œ./app/tcp_ipv4æ—¶ä½¿ç”¨å‚æ•°-wæ‰‹åŠ¨æŒ‡å®šçª—å£å¤§å°ï¼Œç„¶åå‘é€å¾ˆé•¿çš„æŠ¥æ–‡ï¼Œä½¿å¾—å‡ºç°é›¶çª—å£çŠ¶å†µã€‚</p><figure id="1446ec93-d8da-4aa1-a152-a481def6afaf" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2011.png"><img style="width:2560px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2011.png"/></a></figure><h1 id="2ed8f2b4-1843-4644-989b-c4a3940dd5dc" class="">TCPçš„æ‹¥å¡æ§åˆ¶â€”åœ¨CS144ç³»ç»Ÿä¸­ç¼ºå¤±çš„éƒ¨åˆ†</h1><p id="b2a29252-ed28-4e67-8684-6eead705e2ae" class="">CS144çš„å®éªŒè®¾è®¡åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªåºå¤§å¹¶ä¸”è¾ƒå®Œæ•´çš„ç³»ç»Ÿï¼Œå…¶åŸºæœ¬ä¸Šå®ç°äº†TCPçš„åŠŸèƒ½ã€‚ä½†æ˜¯å…¶ä¹Ÿæœ‰ä¸å¤Ÿå®Œå–„çš„åœ°æ–¹ã€‚æ¯”å¦‚åœ¨è®¾è®¡ä¸­çš„æ¥æ”¶çª—å£æ˜¯ä¸€ä¸ªå›ºå®šå€¼ï¼ˆåœ¨ä¸ä½¿ç”¨å‚æ•°æŒ‡å®šçª—å£å¤§å°æ—¶ä¸º64000å­—èŠ‚ï¼‰ï¼Œçª—å£çš„å˜åŒ–ä»…é™äº</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="935155b4-6a89-40ce-84b6-0c09578944af"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">å½“å‰çª—å£å¤§å° = åŸå§‹çª—å£å¤§å° â€“ çª—å£å·²æ¥æ”¶å­—èŠ‚çš„å¤§å°</div></figure><p id="a3938bcb-47c0-4edc-9ddc-6f934fe54057" class="">å…¶å¿½ç•¥äº†TCPæ‹¥å¡æ§åˆ¶ä¸­çš„æ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…ç­‰è¿‡ç¨‹ã€‚</p><p id="3bd7f3a3-8a65-4509-aa3a-c71018f308f1" class="">åœ¨CS144æä¾›çš„å®éªŒå¹³å°ä¸Šå¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œå¤ç°TCPæ‹¥å¡æ§åˆ¶çš„è¿‡ç¨‹ã€‚</p><p id="e39bbeb1-4f15-4d33-9fb7-71e4ed9bf6c9" class="">ä»¥ä¸‹æ˜¯å¯¹TCPReceiverçš„ä¿®æ”¹ã€‚</p><p id="d392d5cf-774f-4ad7-b409-92124d867915" class="">é¦–å…ˆè®¾å®šçª—å£å€¼ä¸º1ï¼Œæ…¢å¯åŠ¨é˜ˆå€¼ssthreshä¸º16ã€‚</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c1e01ff1-0b58-40e9-a629-b001ab004fac" class="code"><code class="language-C++">size_t pre_window_size=1;
size_t ssthresh=16;
int cnt=0;</code></pre><p id="53f5dfe0-0846-441c-80ed-063a7f22ae8c" class="">åœ¨window_size()å‡½æ•°é‡Œä¹Ÿè¿›è¡Œäº†ä¿®æ”¹ï¼Œä½¿ä¹‹ç¬¦åˆæ…¢å¯åŠ¨å’Œæ‹¥å¡é¿å…çš„å·¥ä½œæ–¹å¼ã€‚</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="64544b9e-4f7f-4dbf-a039-bb243f29e592" class="code"><code class="language-C++">size_t TCPReceiver::window_size() const {
    cnt++;
    if(cnt==15)//äººä¸ºæ·»åŠ æ‹¥å¡
    {
        ssthrech=pre_window_size/2;
        pre_window_size=1;
        cnt=10;
    }
    if(pre_window_size*2&lt;=ssthresh)//æ…¢å¯åŠ¨
    {
        pre_window_size=pre_window_size*2;
        return pre_window_size-_reassembler.stream_out().buffer_size();
    } 
    if(pre_window_size&lt;ssthrech&amp;&amp;pre_window_size*2&gt;ssthresh)
    {
        pre_window_size=ssthrech;
        return pre_window_size-_reassembler.stream_out().buffer_size();
    }
    pre_window_size=pre_window_size+1;//æ‹¥å¡é¿å…
    return pre_window_size-_reassembler.stream_out().buffer_size();
//    return _capacity - _reassembler.stream_out().buffer_size();   //åŸæ¥çš„windows_size()å‡½æ•°
}</code></pre><p id="ad00ecc6-1c17-43c0-bb96-88e90f8b5e56" class="">cntæ˜¯äººä¸ºè®¾ç½®çš„ä¸€ä¸ªå€¼ï¼Œå®šä¹‰ä¸ºä¼ è¾“æ¬¡æ•°ã€‚å› ä¸ºæœ¬åœ°è™šæ‹Ÿç½‘å¡é—´çš„TCPè¿æ¥ç›¸å½“çš„ç¨³å®šï¼Œåœ¨æ­£å¸¸ä¼ è¾“çš„æƒ…å†µä¸‹åŸºæœ¬ä¸Šä¸ä¼šå‡ºç°å¼‚å¸¸ï¼Œè€Œä½¿å‘é€çª—å£ä¸æ–­çš„å¢åŠ ã€‚æ‰€ä»¥äººä¸ºè®¾å®šæ¯ä¼ è¾“næ¬¡å°±å‡ºç°ä¸€æ¬¡å¼‚å¸¸ä¼ è¾“ï¼Œå¼•èµ·çª—å£çš„å˜åŒ–ã€‚</p><p id="516bdd9b-0d45-4269-a539-237797c213e7" class="">å¯ä»¥é€šè¿‡wiresharkæ¥è§‚å¯Ÿä¼ è¾“è¿‡ç¨‹ã€‚</p><figure id="2e065348-daa0-45ea-989c-387bfa0182f0" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2012.png"><img style="width:2560px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2012.png"/></a></figure><p id="b3553ea7-e9af-440e-93ee-aec8f12cb28f" class="">ä»¥ä¸‹æ˜¯çª—å£å°ºå¯¸çš„å˜åŒ–æƒ…å†µã€‚ï¼ˆè®¾å®šä¸ºåˆšå¼€å§‹ä¼ è¾“æ—¶ï¼Œç¬¬10æ¬¡ä¼ è¾“å‡ºç°ç¬¬ä¸€æ¬¡è¶…æ—¶é‡ä¼ ï¼Œä¹‹åæ¯äº”æ¬¡ä¼ è¾“å‡ºç°ä¸€æ¬¡è¶…æ—¶ï¼‰</p><figure id="53332c34-2992-405f-8b02-2160a5f246ed" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2013.png"><img style="width:1750px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2013.png"/></a></figure><figure id="0be01832-26f8-4b38-ad0e-25e3477d7471" class="image"><a href="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2014.png"><img style="width:1750px" src="%E5%8E%A6%E9%97%A8%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C2023%E7%A7%8B%E5%AD%A3%E8%AF%BE%E7%A8%8B%E9%A1%B9%E7%9B%AE%202346e101a05f4b048c57e5d0d065cc62/Untitled%2014.png"/></a></figure><p id="7c0221a7-56d2-424a-9d13-615f816f715a" class="">ä»çª—å£å€¼å¯ä»¥çœ‹å‡ºä¸€å¼€å§‹çª—å£å€¼æŒ‡æ•°å¢é•¿ï¼Œåˆ°è¾¾sstreshåæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼Œçº¿æ€§å¢åŠ çª—å£å€¼ï¼Œå‘ç”Ÿè¶…æ—¶åï¼Œçª—å£å€¼è®¾ç½®ä¸º1ï¼Œsstreshè®¾ç½®ä¸ºå½“å‰çª—å£å€¼çš„ä¸€åŠï¼Œé‡æ–°å¼€å§‹æ‰§è¡Œæ…¢å¯åŠ¨å’Œæ‹¥å¡é¿å…ç®—æ³•ã€‚</p><h1 id="b547b325-25d1-4324-8448-7074898b262e" class="">é¡¹ç›®æ€»ç»“</h1><p id="81bc3ec2-6fb4-4f9c-bc50-713c5535eab8" class="">æ€»ç»“æœ¬é¡¹ç›®ï¼Œé¦–å…ˆæŒ‰ç…§CS144å®éªŒæŒ‡å¯¼ä¹¦çš„è¦æ±‚ï¼Œåœ¨Lab0ã€Lab1ï¼ˆåœ¨å®éªŒæŠ¥å‘Šä¸­æœªå†™å‡ºï¼‰ä¸­æ„å»ºäº†æµé‡ç»„å™¨ï¼Œç”¨äºé‡ç»„æœªæŒ‰åºåˆ°è¾¾çš„å­—èŠ‚æµï¼Œè¿™ä¸ªæµé‡ç»„å™¨ä½œä¸ºåº•å±‚ï¼Œå‘ä¸Šå±‚çš„TCP Senderå’ŒTCP Receiveræä¾›æœåŠ¡ã€‚åœ¨Lab2ä¸­æ„å»ºäº†TCP Receiverï¼Œåœ¨Lab3ä¸­æ„å»ºäº†TCP Senderï¼Œåœ¨Lab4ä¸­å°†ä»¥ä¸Šå‡ ä¸ªå®éªŒç»“åˆèµ·æ¥æ„å»ºå‡ºTCP Connectionï¼Œå³æ˜¯TCPçš„æœ‰é™çŠ¶æ€æœºã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­éœ€è¦å¯¹TCPçš„ç‰¹æ€§æœ‰ä¸€å®šçš„äº†è§£ï¼Œå¹¶æŒ‰ç…§RFCæ–‡æ¡£å’Œè¯¾ç¨‹çš„è¦æ±‚è¿›è¡Œä»£ç çš„ç¼–å†™ã€‚æœ€åé€šè¿‡è‡ªå·±æ„å»ºçš„è¿™ä¸ªTCPåè®®æ ˆå¯ä»¥æˆåŠŸå®ç°å’Œäº’è”ç½‘è¿›è¡Œé€šä¿¡ã€ç”¨äºå®¢æˆ·å’ŒæœåŠ¡å™¨é—´é€šä¿¡ã€‚åœ¨å®Œæˆäº†CS144çš„å®éªŒä»»åŠ¡åï¼Œåˆ©ç”¨æ„å»ºå‡ºçš„TCP FSMï¼Œå¯¹TCPçš„ä¸€äº›ç‰¹æ€§è¿›è¡Œäº†æ¢ç©¶ï¼Œä¾‹å¦‚TCPçš„æ‹¥å¡æ§åˆ¶ï¼šæ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…ç®—æ³•ã€‚ä»¥åŠé›¶çª—å£é—®é¢˜çš„è®¾è®¡æ¢ç©¶ï¼Œå¹¶ä½¿ç”¨Wiresharkè§‚å¯Ÿ TCPçš„è¿æ¥è¿‡ç¨‹ã€‚</p><h1 id="10ca0b1b-484a-446a-9431-81d87189294d" class="">å‚è€ƒèµ„æ–™ï¼š</h1><p id="9ff4c79e-a3f3-4ba7-be2f-97351a182e91" class="">[1]Ramakrishnan K, Floyd S, Black D. The TCP Congestion Control System[J]. RFC 3465, 2003. <a href="https://tools.ietf.org/html/rfc3465">https://tools.ietf.org/html/rfc3465</a></p><p id="bf16aa4b-898d-4bc0-bad7-fc4230825a1f" class="">[2]IETF. Computing TCP&#x27;s Retransmission Timer[J]. RFC 6298, 2011. <a href="https://tools.ietf.org/html/rfc6298">https://tools.ietf.org/html/rfc6298</a></p><p id="838ebbd9-fd9b-48d4-a422-06fd04067f3d" class="">[3]Allman M, Paxson V, Stevens W. TCP Congestion Control[J]. RFC 5681, 2009. <a href="https://tools.ietf.org/html/rfc5681">https://tools.ietf.org/html/rfc5681</a></p><p id="bcf7d7f4-5ecc-4ba4-8353-27136cec2d59" class="">[4]Welzl M, Nordmark E, Briscoe B. TCP: Specification of the Transmission Control Protocol[J]. RFC 9293, 2022. <a href="https://tools.ietf.org/html/rfc9293">https://tools.ietf.org/html/rfc9293</a></p><p id="184e32a5-1ef1-46ba-a5d0-8569c4b76ae8" class="">[5]è®¡ç®—æœºç½‘ç»œ-è‡ªé¡¶å‘ä¸‹æ–¹æ³•</p><p id="540471f6-bc40-4dc1-a53c-229b713468a5" class="">
</p><h3 id="a4538c5c-d6ca-46c4-8c0c-738b6c3ae95c" class="">é¡¹ç›®æˆå‘˜</h3><p id="3cfe6e9a-825a-4513-b58f-6c958ef3ec95" class="">22920212204312  éƒ‘ç¨‹ç¡•  </p><p id="2372dea9-4800-45dc-be2b-eeeb3fcbd865" class="">æœ¬é¡¹ç›®ä¸ºå•äººé¡¹ç›®ï¼Œé€‰é¢˜ã€ä»£ç ã€é¡¹ç›®æŠ¥å‘Šã€PPTã€æ±‡æŠ¥ç­‰å†…å®¹å‡ç”±æœ¬äººå®Œæˆã€‚</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>